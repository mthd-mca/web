pipeline{
  agent anY
  
  ENVIRONMENT {
     DOCKERHUB_CREDENTIALS = credentials('dockerhubID')
	 IMAGE_NAME = "675711/my-webapp"
  }
  
  stages{
	stage('checkout'){
	  steps{
		git{
		url:"https://",branch:'main',credentialsid:'dockerhubid'
		}
		}
	  }
	stage('Build Docker image'){
	  steps{
	  script{
			dokerimage = docker:build("${IMAGE_NAME}:latest")
	}
	}
	}
	
	stage("Push to dockerhub"){
	  steps{
	    script{
	      docker_withRegistry("https://index.docker.io/v1/'dockerhubID'")
	      {
	        dockerImage.push()
	      }
	    }
	  }
	}
	
	post{
	  always{
	    echo "cleaning up workspace"
	    deletedir()
	  }
	  success{
	    echo ""pipeline succeded!"
	  }
	  failure {
	    echo ''pipeline failed"
	  }
	}
  }
  
}
